import { VerticalBox , HorizontalBox} from "std-widgets.slint";
import { CellWidget } from "cell.slint";
import { NoteValueWidget } from "note_value.slint";
import { NoteStateWidget } from "note_state.slint";
import { Plot } from "../widgets/plot.slint";
import { BMSModelService } from "../models/bms.slint";

export component BMSView inherits Rectangle {
    background: #ffffff00;

    out property voltage_plot_width <=> v_plot.width;
    out property voltage_plot_height <=> v_plot.height;
    out property current_plot_width <=> c_plot.width;
    out property current_plot_height <=> c_plot.height;

    VerticalBox {
        spacing: 5px;
        HorizontalBox {
            for cell in [0,1,2,3,4] : CellWidget { 
                cell-number: cell + 1; 
                voltage: BMSModelService.bms-info.cell-voltage[cell]; 
            }
        }
        HorizontalBox {
            NoteValueWidget { 
                title: "Voltage";
                text: BMSModelService.bms-info.voltage+"V";
            }
            NoteValueWidget { 
                title: "Current";
                text: BMSModelService.bms-info.current+"A";
            }
            NoteValueWidget { 
                title: "Temperature";
                text: BMSModelService.bms-info.temperature+"â„ƒ";
            }
            NoteStateWidget { 
                title: "DSG";
                state: BMSModelService.bms-info.dsg;
            }
            NoteStateWidget { 
                title: "CHG";
                state: BMSModelService.bms-info.chg;
            }
        }

        HorizontalBox {
            v_plot := Plot { 
                title: "Voltage plot"; 
                source: BMSModelService.bms-info.voltage-plot;
            }
            c_plot := Plot { 
                title: "Current plot"; 
                source: BMSModelService.bms-info.current-plot;
            }
        }
        Rectangle{

        }
    }
}